# 住民向けUX・インセンティブ設計（ひなんけいろ）

Agent C 担当。若年層〜高齢者まで、特に高齢者がスマホで簡単に操作でき、楽しみながら継続し、行政貢献と自分メリットの両方を感じられる設計とする。

---

## 0. プロジェクト方針（確定事項）

| # | 項目 | 方針 |
|---|------|------|
| 1 | **地域** | 今回は**浜松市のみ**。最終的には**日本国内の沿岸部全地域**を想定。 |
| 2 | **認証** | **匿名のみ**でOK（端末内の匿名IDで訓練ログを紐づけ）。 |
| 3 | **貢献の見せ方** | **過去の貢献回数**を表示し、**あと何回でご褒美がもらえるか**を見せる。**行政側の感謝の気持ち**も伝える。 |
| 4 | **文字サイズ** | **端末のアクセシビリティ設定に委ねる**（アプリ内の「大きくする」トグルは今回は作らない）。 |
| 5 | **有事モード** | **有事ボタン**を押すとモード切り替え。**デフォルトは平時モード**。 |
| 6 | **「同じ経路」の定義** | **避難経路も含めて**同じとみなす（出発地・避難所に加え、経路座標の一致または十分な類似で判定）。 |
| 7 | **ご褒美・ポイント** | **地域事業者にスポンサーを募る**。**浜松市ローカルで使えるポイント**が付与されるイメージ。 |

---

## 1. ターゲットと操作のしやすさ

- **対象**: 若年〜高齢者。高齢者でも自分のスマホで迷わず操作できることを最優先する。
- **方針**:
  - **大きなタップ領域**: ボタン・リンクは最小 44px（推奨 48px）以上。余白を多めに。
  - **文字サイズ**: 本文は 16px 以上、重要な案内は 18px〜20px。**文字の拡大は端末のアクセシビリティ設定に委ねる**（アプリ内トグルは今回は持たない）。
  - **コントラスト**: 文字と背景のコントラスト比を十分に（WCAG AA 以上を目安）。
  - **操作ステップの削減**: 訓練開始は「1タップで開始」に近づける。設定は少なめにし、デフォルトで動くようにする。
  - **フィードバック**: タップしたら即座に視覚・触覚（バイブ）で反応があるようにする。
  - **戻る・ホーム**: どの画面からも「ホーム」「戻る」が分かりやすく、迷子にしない。
- **実装**: 共通の大きなボタン・カードコンポーネント、`globals.css` のアクセシビリティ用 CSS 変数（タップサイズ・余白）を定義し、住民向け画面で一貫して利用する。

---

## 2. 楽しくなるインセンティブ設計

- **地域ポイント（ご褒美）**
  - **地域事業者にスポンサーを募り**、**浜松市ローカルで使えるポイント**を付与する。訓練回数など条件を満たすと「あと○回でご褒美」→ 付与、という流れ（`IncentiveCampaign` / `IncentiveCondition` に準拠）。
- **ポイント・ランク**
  - 訓練1回ごとにアプリ内ポイント付与（距離・所要時間・「時間内に避難完了」でボーナス）。ランクは段階的に（はじめて → なれてきた → つづけてる → まもりびと）。
- **バッジ**
  - 初回完了、連続○回、月間○km、夜間訓練、「いつもの道」（**同じ経路を複数回**）など。獲得時に軽いアニメーションと短いメッセージで喜びを伝える。
- **週間・月間の達成率**
  - 「今週○回／目標○回」「今月○km」のように、短期目標で「もう少し」を促す。
- **励ましメッセージ**
  - 訓練後や久しぶりログイン時に、前向きな一言を表示。

---

## 3. 行政に役立っている感覚（貢献の可視化）

- **自分のログがどう使われるか**
  - 同意画面・設定で「匿名で集計され、避難経路の改善や防災計画に使われます」と簡潔に説明。
- **貢献の見える化（方針: 回数・ご褒美まで・行政の感謝）**
  - **過去の貢献回数**を表示する（例: 「あなたの訓練データは ○回、防災計画に活用されています」）。
  - **あと何回でご褒美がもらえるか**を見せる（例: 「あと 2 回で地域ポイント付与」）。キャンペーン条件は `IncentiveCondition` / `IncentiveCampaign` に準拠。
  - **行政側の感謝の気持ち**を伝える（例: 行政から提供された感謝メッセージや「浜松市からのお礼」文言を表示）。
  - 型: `UserContributionSummary` に `rewardsProgress`（ご褒美までの残り回数）と `governmentThankYouMessage`（行政の感謝文）を追加。
- **同意フロー**
  - 訓練前に「行政と匿名で共有しますか？」を分かりやすい文言で選択。拒否しても訓練は可能で、自分用の記録は残る。

---

## 4. 自分にもメリットがある

- **健康・運動**
  - 歩いた距離・時間を記録し、「今月○km 歩いた」と表示。日々の運動としての価値を伝える。
- **ランク・バッジ・ポイント**
  - 上記インセンティブが「自分の成長・達成」として楽しめるようにする。
- **有事のときに自分を助ける**
  - 平時の訓練が、いざというときの「自分の能力に合ったガイド」と「体で覚えた経路」につながることを、アプリ内で繰り返し伝える（下記 5・6・7）。

---

## 5. 平時のトレーニング促進・励まし

- **ホーム・ダッシュボード**
  - 次にやること（「今日は訓練してみる？」「今週あと○回で目標達成」）を一言で表示。
- **リマインド・促し**
  - 久しぶり利用時は「また備えを始めよう」、連続利用時は「続けてるね、すごい」など、励ましのメッセージ。
- **目標の柔軟さ**
  - 週1回・月○回など、自分で選べる目標（任意）で、達成時に祝福する。

---

## 6. 有事の際：スマホがあるとき（過去ログに基づくガイド）

- **モード切り替え**
  - **デフォルトは平時モード**。**有事ボタン**を押すと有事モードに切り替え、避難ガイドを表示する。
- **コンセプト**
  - 有事モードでは**過去の訓練ログ**を元に、**自分の歩く速度・よく使う経路**に合わせて避難をガイドする。
- **必要なデータ（型は shared/types または Agent A と共有）**
  - ユーザーごとの「平均歩行速度」「よく選んだ避難所・経路」「所要時間の傾向」など。これらは訓練ログから算出可能（`EmergencyGuideProfile`）。
- **UI イメージ**
  - 有事モードでは「あなたのペースなら、この経路で約○分。落ち着いて避難してください」のように、**その人に合わせた時間・経路**を表示する。
- **担当**
  - データは Agent B（訓練ログ）、表示・経路は Agent A（地図・シミュレーション）と連携。Agent C は「有事ボタン・モード切替UI・住民向け説明・励ましメッセージ」を担当。

---

## 7. スマホがない場合：体で覚えている

- **コンセプト**
  - スマホが手元にない・使えない状況でも、**何度も同じ経路を訓練しているので、体が覚えている**状態を目指す。
- **アプリ側でやること**
  - **同じ経路を繰り返し歩く**ことを促す設計にする。
    - 例: 「いつもの避難所まで、もう一度歩いてみよう」「この経路を○回歩くと“いつもの道”バッジ」など。
  - 訓練後のメッセージで「この経路を繰り返すと、いざというときも体が覚えています」と伝える。
  - 複数シナリオ（自宅→避難所A、職場→避難所B など）を選べるようにし、「よく行く場所ごとの経路」を体に染み込ませる。
- **設計上のポイント**
  - **「同じ経路」の定義**: 出発地・避難所に加え、**避難経路（ルート座標）も含めて**同じとみなす。経路座標の一致または十分な類似（例: 同一道路・同じ曲がり角）で判定する。
  - 経路の**一貫性**と**反復のインセンティブ**（「いつもの道」バッジ・ポイント・励まし）を組み合わせる。

---

## 8. まとめ（実装の優先度）

| 優先度 | 内容 |
|--------|------|
| 高 | 大きなボタン・読みやすい文字・少ないステップで訓練開始（高齢者でも操作しやすいUI） |
| 高 | ポイント・ランク・バッジ・週間/月間達成で「楽しい」インセンティブ |
| 高 | 行政共有の同意フローと「あなたのデータが役立っている」の可視化 |
| 高 | 訓練後の励まし・平時の「もう一歩」を促すメッセージ |
| 中 | 健康指標（歩数・距離）の表示と「自分メリット」の訴求 |
| 中 | 有事時：過去ログに基づく「あなたの能力に合わせたガイド」（Agent A/B と連携） |
| 中 | 「同じ経路を繰り返す→体で覚える」を促すバッジ・文言・経路選択UI |

このドキュメントは `docs/ARCHITECTURE.md` および `shared/types.ts` と整合を取ること。
